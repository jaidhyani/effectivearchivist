---
import { getCollection } from "astro:content";
import Base from "../../layouts/Base.astro";

const recipes = await getCollection("recipes");
const tagMap = new Map<string, number>();
for (const r of recipes) {
  for (const tag of r.data.tags) {
    tagMap.set(tag, (tagMap.get(tag) || 0) + 1);
  }
}
const tags = [...tagMap.entries()].sort((a, b) => a[0].localeCompare(b[0]));
---

<Base title="Dietary Tags">
  <h1>Dietary Tags</h1>
  <ul class="filter-list">
    {tags.map(([name, count]) => (
      <li>
        <a href={`/tags/${name.toLowerCase().replace(/\s+/g, "-").replace(/[()]/g, "")}/`}>
          {name} ({count})
        </a>
      </li>
    ))}
  </ul>
</Base>
