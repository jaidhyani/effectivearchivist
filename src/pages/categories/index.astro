---
import { getCollection } from "astro:content";
import Base from "../../layouts/Base.astro";

const recipes = await getCollection("recipes");
const categoryMap = new Map<string, number>();
for (const r of recipes) {
  const cat = r.data.category;
  if (cat) categoryMap.set(cat, (categoryMap.get(cat) || 0) + 1);
}
const categories = [...categoryMap.entries()].sort((a, b) => a[0].localeCompare(b[0]));
---

<Base title="Categories">
  <h1>Categories</h1>
  <ul class="filter-list">
    {categories.map(([name, count]) => (
      <li>
        <a href={`/categories/${name.toLowerCase().replace(/\s+/g, "-").replace(/[()]/g, "")}/`}>
          {name} ({count})
        </a>
      </li>
    ))}
  </ul>
</Base>
